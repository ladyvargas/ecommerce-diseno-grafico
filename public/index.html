<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CNC CAMPAS - Fabricaci√≥n Digital Profesional</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/footer.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/whatsapp-float.css">
</head>

<body>
    <a id="whatsappFloat" href="#" target="_blank" class="whatsapp-float" title="Cont√°ctanos por WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- HERO SECTION CON CARRUSEL - 3 SECCIONES -->
    <section class="main-banner" id="heroSection">
        <!-- SECCI√ìN 1: CONTENIDO TEXTO -->
        <div class="brown-side">
            <div class="content" id="heroContent">
                <h1 id="heroTitle">Cargando servicios...</h1>
                <p id="heroDescription">Por favor espera mientras cargamos la informaci√≥n.</p>
                <button class="btn-cta" onclick="window.location.href='/pages/services.html'">
                    Contratar ahora
                </button>
            </div>
        </div>
        <div class="oval-mask"></div>
        <div class="oval-line"></div>

        <!-- SECCI√ìN 2: IMAGEN -->
        <div class="machine-box">
            <img id="machineImage" src="/img/placeholder-servicio.png" alt="Servicio">
        </div>

        <!-- SECCI√ìN 3: BOTONES LATERALES -->
        <div class="tags-side" id="heroImage">
            <!-- Se cargan din√°micamente -->
        </div>
    </section>

    <!-- PRODUCTOS DESTACADOS -->
    <section class="productos-section">
        <h2>PRODUCTOS DESTACADOS</h2>
        <p class="productos-subtitle">Descubre nuestros servicios m√°s solicitados con la mejor calidad y precisi√≥n</p>
        <div class="productos-grid" id="productosGrid">
            <!-- Se cargan din√°micamente -->
        </div>
        <button class="ver-todos-btn" onclick="window.location.href='/pages/productos.html'">
            Ver Todos los Productos
        </button>
    </section>

    <!-- NUESTROS SERVICIOS -->
    <section class="services-section">
        <div class="services-header">
            <h2>NUESTROS SERVICIOS</h2>
            <p class="services-subtitle">Soluciones profesionales de fabricaci√≥n digital</p>
        </div>

        <!-- Servicios Destacados (2 grandes) -->
        <div class="services-featured">
            <div class="service-card-large">
                <div class="service-card-content">
                    <div class="service-number">01</div>
                    <div class="service-icon-large">
                        <i class="fas fa-cog"></i>
                    </div>
                    <h3>Router CNC Profesional</h3>
                    <p>Corte y mecanizado CNC de alta precisi√≥n en madera, MDF, plywood, PVC y alucobond. Ideal para
                        letras corp√≥reas, displays y piezas personalizadas con acabados perfectos.</p>
                    <div class="service-tags">
                        <span>Madera</span>
                        <span>MDF</span>
                        <span>Acr√≠lico</span>
                        <span>PVC</span>
                    </div>
                </div>
                <div class="service-decoration"></div>
            </div>

            <div class="service-card-large">
                <div class="service-card-content">
                    <div class="service-number">02</div>
                    <div class="service-icon-large">
                        <i class="fas fa-cut"></i>
                    </div>
                    <h3>Corte y Grabado L√°ser</h3>
                    <p>Corte y grabado l√°ser de precisi√≥n en m√∫ltiples materiales. Perfecto para dise√±os detallados,
                        se√±al√©tica personalizada y productos de alta calidad con acabados excepcionales.</p>
                    <div class="service-tags">
                        <span>Alta Precisi√≥n</span>
                        <span>Grabado</span>
                        <span>Detalles Finos</span>
                    </div>
                </div>
                <div class="service-decoration"></div>
            </div>
        </div>

        <!-- Servicios Secundarios (4 medianas) -->
        <div class="services-grid-compact">
            <div class="service-card-medium">
                <div class="service-icon-medium">
                    <i class="fas fa-print"></i>
                </div>
                <h3>Impresi√≥n UV</h3>
                <p>Impresi√≥n directa UV sobre cualquier superficie con colores vibrantes y durabilidad excepcional.</p>
                <div class="service-link">
                    <i class="fas fa-arrow-right"></i>
                </div>
            </div>

            <div class="service-card-medium">
                <div class="service-icon-medium">
                    <i class="fas fa-cube"></i>
                </div>
                <h3>Impresi√≥n 3D</h3>
                <p>Prototipado r√°pido y fabricaci√≥n de piezas personalizadas con m√∫ltiples materiales disponibles.</p>
                <div class="service-link">
                    <i class="fas fa-arrow-right"></i>
                </div>
            </div>

            <div class="service-card-medium">
                <div class="service-icon-medium">
                    <i class="fas fa-image"></i>
                </div>
                <h3>Plotter Gran Formato</h3>
                <p>Impresi√≥n de gran formato para vallas publicitarias, r√≥tulos, banners y lonas de alta calidad.</p>
                <div class="service-link">
                    <i class="fas fa-arrow-right"></i>
                </div>
            </div>

            <div class="service-card-medium">
                <div class="service-icon-medium">
                    <i class="fas fa-lightbulb"></i>
                </div>
                <h3>Letreros LED</h3>
                <p>Fabricaci√≥n de letreros LED luminosos personalizados con bajo consumo y m√°xima visibilidad.</p>
                <div class="service-link">
                    <i class="fas fa-arrow-right"></i>
                </div>
            </div>
        </div>
    </section>

    <!-- TESTIMONIOS -->
    <section class="testimonios-section">
        <h2>LO QUE DICEN NUESTROS CLIENTES</h2>
        <div class="testimonios-container">
            <div class="testimonio-card">
                <div class="testimonio-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                <p class="testimonio-text">"Excelente servicio y calidad en el corte CNC. Los acabados son impecables y
                    la entrega fue puntual. Altamente recomendado."</p>
                <div class="testimonio-author">
                    <strong>Mar√≠a Gonz√°lez</strong>
                    <span>Empresa de Dise√±o Interior</span>
                </div>
            </div>
            <div class="testimonio-card">
                <div class="testimonio-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                <p class="testimonio-text">"El grabado l√°ser qued√≥ perfecto. Muy profesionales y atentos a los detalles.
                    Sin duda volver√© a trabajar con ellos."</p>
                <div class="testimonio-author">
                    <strong>Carlos Mendoza</strong>
                    <span>Tienda de Regalos Personalizados</span>
                </div>
            </div>
            <div class="testimonio-card">
                <div class="testimonio-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                <p class="testimonio-text">"Los letreros LED superaron nuestras expectativas. Excelente comunicaci√≥n y
                    asesor√≠a durante todo el proyecto."</p>
                <div class="testimonio-author">
                    <strong>Ana Ruiz</strong>
                    <span>Restaurante El Sabor</span>
                </div>
            </div>
        </div>
    </section>

    <!-- POR QU√â ELEGIRNOS -->
    <section class="porque-section">
        <div class="porque-container">
            <div class="porque-content">
                <h2>¬øPOR QU√â ELEGIRNOS?</h2>
                <div class="porque-grid">
                    <div class="porque-item">
                        <div class="porque-icon"><i class="fas fa-award"></i></div>
                        <h3>Calidad Garantizada</h3>
                        <p>Trabajos de alta calidad con los mejores acabados y atenci√≥n al detalle.</p>
                    </div>
                    <div class="porque-item">
                        <div class="porque-icon"><i class="fas fa-clock"></i></div>
                        <h3>Entrega Puntual</h3>
                        <p>Cumplimos con los tiempos acordados sin comprometer la calidad.</p>
                    </div>
                    <div class="porque-item">
                        <div class="porque-icon"><i class="fas fa-tools"></i></div>
                        <h3>Tecnolog√≠a Moderna</h3>
                        <p>Equipos de √∫ltima generaci√≥n para resultados profesionales.</p>
                    </div>
                    <div class="porque-item">
                        <div class="porque-icon"><i class="fas fa-headset"></i></div>
                        <h3>Asesor√≠a Personalizada</h3>
                        <p>Te ayudamos a encontrar la mejor soluci√≥n para tu proyecto.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CONTACTO -->
    <section class="contacto-section" id="contacto">
        <h2 class="contacto-title">CONT√ÅCTANOS</h2>
        <p class="contacto-subtitle">
            Estamos listos para ayudarte en tus proyectos de corte, grabado e impresi√≥n profesional.
        </p>
        <div class="contacto-grid">
            <div class="contacto-card">
                <i class="fas fa-map-marker-alt"></i>
                <h4>Ubicaci√≥n</h4>
                <p id="contactAddress">Cargando...</p>
            </div>

            <div class="contacto-card">
                <i class="fas fa-phone"></i>
                <h4>Tel√©fono</h4>
                <p id="contactPhone">Cargando...</p>
            </div>

            <div class="contacto-card">
                <i class="fas fa-envelope"></i>
                <h4>Email</h4>
                <p id="contactEmail">Cargando...</p>
            </div>

            <div class="contacto-card">
                <i class="fas fa-clock"></i>
                <h4>Horario</h4>
                <p id="contactHours">Cargando...</p>
            </div>
        </div>
    </section>

    <script>
        // ============================================
        // üî• CONFIGURACI√ìN DE LA API
        // ============================================
        const API_BASE = 'https://ecommerce-diseno-grafico-production.up.railway.app';
        const API_URL = `${API_BASE}/api`;

        // ============================================
        // üìä VARIABLES GLOBALES
        // ============================================
        let machines = {}; // Se llena din√°micamente desde la BD
        let currentMachine = null; // Se establece cuando se cargan los datos
        let autoplayInterval = null;

        // ============================================
        // üõ†Ô∏è FUNCIONES AUXILIARES
        // ============================================
        /**
         * Normaliza texto para comparaciones
         */
        function normalizeText(text = '') {
            return text
                .toLowerCase()
                .normalize('NFD')
                .replace(/[\u0300-\u036f]/g, '')
                .replace(/[^a-z0-9]+/g, '-')
                .replace(/(^-|-$)/g, '');
        }

        /**
         * Extrae etiqueta corta del nombre del servicio
         */
        function getShortLabel(serviceName) {
            // Mapeo de palabras clave a etiquetas cortas
            const keywords = {
                'router': 'ROUTER CNC',
                'cnc': 'ROUTER CNC',
                'corte.*laser': 'CORTE L√ÅSER',
                'grabado.*laser': 'CORTE L√ÅSER',
                'laser.*fibra': 'L√ÅSER FIBRA',
                'fibra': 'L√ÅSER FIBRA',
                'impresora.*uv': 'IMPRESORA UV',
                'uv.*dtf': 'IMPRESORA UV',
                'impresion.*uv': 'IMPRESORA UV',
                'impresora.*3d': 'IMPRESORA 3D',
                'impresion.*3d': 'IMPRESORA 3D',
                '3d': 'IMPRESORA 3D',
                'plotter': 'PLOTTER',
                'sublimacion': 'SUBLIMACION',
                'sublimaci√≥n': 'SUBLIMACION'
            };

            const normalizedName = serviceName.toLowerCase();

            // Buscar coincidencia
            for (const [pattern, label] of Object.entries(keywords)) {
                const regex = new RegExp(pattern, 'i');
                if (regex.test(normalizedName)) {
                    return label;
                }
            }

            // Si no hay coincidencia, extraer primeras 2-3 palabras significativas
            const words = serviceName.toUpperCase().split(' ')
                .filter(w => w.length > 2 && !['DE', 'LA', 'EL', 'LOS', 'LAS'].includes(w))
                .slice(0, 2);

            return words.join(' ') || serviceName.toUpperCase().substring(0, 15);
        }

        /**
         * Resuelve URL de imagen completa
         */
        function resolveImage(image) {
            if (!image || typeof image !== 'string') return '/img/placeholder-servicio.png';
            if (image.startsWith('http://') || image.startsWith('https://')) return image;
            if (image.includes('uploads')) {
                return API_BASE + (image.startsWith('/') ? image : '/' + image);
            }
            return '/img/placeholder-servicio.png';
        }

        /**
         * Genera colores alternos para el banner
         */
        function getColorScheme(index) {
            const schemes = [
                {
                    primary: '#243977',
                    primaryDark: '#243977',
                    accent: '#CDA870',
                    gradient: 'radial-gradient(circle at 15% 25%, #2c4389 0%, #243977 100%)'
                },
                {
                    primary: '#243977',
                    primaryDark: '#243977',
                    accent: '#CDA870',
                    gradient: 'radial-gradient(circle at 15% 25%, #2c4389 0%, #243977 100%)'
                }
            ];
            return schemes[index % 2];
        }

        // ============================================
        // üé® CARGAR SERVICIOS DESDE LA BASE DE DATOS
        // ============================================
        async function loadServicesFromDB() {
            try {
                console.log('üîÑ Cargando servicios desde la BD...');
                const response = await fetch(`${API_URL}/products`);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const products = await response.json();

                // Filtrar solo productos de categor√≠a "Servicios"
                const services = products.filter(p =>
                    p.category && p.category.toLowerCase() === 'servicios'
                );

                console.log(`‚úÖ ${services.length} servicios encontrados`);

                // Reiniciar el objeto machines
                machines = {};

                // Construir din√°micamente el objeto machines
                services.forEach((service, index) => {
                    const key = normalizeText(service.name);
                    const colors = getColorScheme(index);

                    machines[key] = {
                        id: service.id,
                        title: service.name.toUpperCase(),
                        shortLabel: (service.file_format && service.file_format.trim())
                            ? service.file_format.trim().toUpperCase()
                            : getShortLabel(service.name),
                        description: service.description || 'Servicio profesional de alta calidad',
                        image: resolveImage(service.image),
                        colors: colors,
                        category: service.category
                    };
                });

                // Establecer el primer servicio como activo
                const firstKey = Object.keys(machines)[0];
                if (firstKey) {
                    currentMachine = firstKey;
                    console.log('‚úÖ Servicio inicial:', currentMachine);
                }

                // Generar botones del banner
                renderBannerButtons();

                // Cambiar a la primera m√°quina
                if (currentMachine) {
                    changeMachine(currentMachine);
                }

                return services;

            } catch (error) {
                console.error('‚ùå Error cargando servicios:', error);

                // Mostrar mensaje de error en el banner
                document.getElementById('heroTitle').textContent = 'Error al cargar servicios';
                document.getElementById('heroDescription').textContent =
                    'No se pudieron cargar los servicios. Por favor, recarga la p√°gina.';

                return [];
            }
        }

        // ============================================
        // üéØ RENDERIZAR BOTONES DEL BANNER
        // ============================================
        function renderBannerButtons() {
            const tagsSide = document.querySelector('.tags-side');

            if (!tagsSide) {
                console.error('‚ùå Elemento .tags-side no encontrado');
                return;
            }

            // Limpiar botones existentes
            tagsSide.innerHTML = '';

            // Crear un bot√≥n por cada servicio
            Object.keys(machines).forEach((key, index) => {
                const button = document.createElement('button');
                button.className = 'tag';
                if (index === 0) button.classList.add('active');

                button.dataset.machine = key;
                button.textContent = machines[key].shortLabel || machines[key].title; // Usar etiqueta corta

                // Agregar evento click
                button.addEventListener('click', () => {
                    changeMachine(key);
                    resetAutoplay();
                });

                tagsSide.appendChild(button);
            });

            console.log(`‚úÖ ${Object.keys(machines).length} botones renderizados`);
        }

        // ============================================
        // üîÑ CAMBIAR M√ÅQUINA/SERVICIO EN EL BANNER
        // ============================================
        function changeMachine(machineKey) {
            const machine = machines[machineKey];

            if (!machine) {
                console.warn('‚ö†Ô∏è M√°quina no encontrada:', machineKey);
                return;
            }

            console.log('üîÑ Cambiando a:', machineKey);

            currentMachine = machineKey;

            // Actualizar t√≠tulo (nombre completo) y descripci√≥n
            document.getElementById('heroTitle').textContent = machine.title || 'Servicio Profesional';
            document.getElementById('heroDescription').textContent = machine.description || '';

            // Actualizar imagen
            const imgEl = document.getElementById('machineImage');
            const imageUrl = machine.image;

            imgEl.onerror = () => {
                imgEl.onerror = null;
                imgEl.src = '/img/placeholder-servicio.png';
            };
            imgEl.src = imageUrl;

            // Aplicar colores
            const banner = document.querySelector('.main-banner');
            if (banner && machine.colors) {
                banner.style.setProperty('--primary', machine.colors.primary);
                banner.style.setProperty('--primary-dark', machine.colors.primaryDark);
                banner.style.setProperty('--accent', machine.colors.accent);
                banner.style.setProperty('--gradient', machine.colors.gradient);
            }

            // Actualizar botones activos
            document.querySelectorAll('.tag').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.machine === machineKey);
            });
        }

        // ============================================
        // ‚è±Ô∏è AUTOPLAY DEL BANNER
        // ============================================
        function startAutoplay() {
            const machineKeys = Object.keys(machines);

            if (machineKeys.length === 0) {
                console.warn('‚ö†Ô∏è No hay servicios para el autoplay');
                return;
            }

            let currentIndex = machineKeys.indexOf(currentMachine);
            if (currentIndex < 0) currentIndex = 0;

            clearInterval(autoplayInterval);

            autoplayInterval = setInterval(() => {
                currentIndex = (currentIndex + 1) % machineKeys.length;
                changeMachine(machineKeys[currentIndex]);
            }, 5000);

            console.log('‚ñ∂Ô∏è Autoplay iniciado');
        }

        function resetAutoplay() {
            console.log('üîÑ Reiniciando autoplay');
            startAutoplay();
        }

        // ============================================
        // üì¶ CARGAR PRODUCTOS DESTACADOS
        // ============================================
        async function loadProducts() {
            try {
                const response = await fetch(`${API_URL}/products`);
                const products = await response.json();

                const featured = products
                    .filter(p =>
                        p.featured &&
                        p.category &&
                        p.category.toLowerCase() !== 'servicios'
                    )
                    .slice(0, 6);

                console.log('‚úÖ Productos destacados cargados:', featured.length);

                const grid = document.getElementById('productosGrid');

                if (featured.length === 0) {
                    grid.innerHTML = `
                        <div style="grid-column: 1/-1; text-align: center; padding: 3rem; color: #666;">
                            <p>No hay productos destacados disponibles</p>
                        </div>
                    `;
                    return;
                }

                grid.innerHTML = featured.map(product => {
                    const price = parseFloat(product.price) || 0;
                    const salePrice = product.sale_price ? parseFloat(product.sale_price) : null;
                    const precio = salePrice || price;
                    const descuento = salePrice ? Math.round(((price - salePrice) / price) * 100) : 0;

                    return `
                        <div class="producto-card">
                            <div class="producto-img-container">
                                <img src="${resolveImage(product.image)}" alt="${product.name}" class="producto-img">
                                ${product.featured && product.trending ?
                            '<div class="producto-badge destacado">‚ú® Destacado</div>' :
                            salePrice ?
                                `<div class="producto-badge oferta">-${descuento}% OFF</div>` :
                                ''
                        }
                            </div>
                            <div class="producto-content">
                                <div class="producto-categoria">${product.category}</div>
                                <h3>${product.name}</h3>
                                <p class="producto-description">${product.description}</p>
                                <div class="producto-footer">
                                    <div class="producto-precio-container">
                                        ${salePrice ?
                            `<div class="producto-precio-old">$${price.toFixed(2)}</div>` :
                            ''
                        }
                                        <div class="producto-precio">$${precio.toFixed(2)}</div>
                                    </div>
                                    <button class="producto-btn" onclick="window.location.href='/pages/product.html?id=${product.id}'">
                                        Ver m√°s <i class="fas fa-arrow-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('‚ùå Error cargando productos:', error);
                document.getElementById('productosGrid').innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 3rem; color: #666;">
                        <i class="fas fa-exclamation-circle" style="font-size: 3rem; margin-bottom: 1rem; color: #ccc;"></i>
                        <p>No se pudieron cargar los productos. Intenta recargar la p√°gina.</p>
                    </div>
                `;
            }
        }

        // ============================================
        // üìû CARGAR INFORMACI√ìN DE CONTACTO
        // ============================================
        async function loadDynamicContact() {
            try {
                const res = await fetch(`${API_URL}/settings`);
                const settings = await res.json();

                document.getElementById("contactAddress").textContent = settings.store_address || "No disponible";
                document.getElementById("contactPhone").textContent = settings.store_phone || "No disponible";
                document.getElementById("contactEmail").textContent = settings.store_email || "No disponible";
                document.getElementById("contactHours").textContent = settings.store_schedule || "No disponible";
            } catch (err) {
                console.error("‚ùå Error cargando datos de contacto:", err);
            }
        }

        // ============================================
        // üë§ GESTI√ìN DE USUARIO
        // ============================================
        document.addEventListener("DOMContentLoaded", function () {
            const hamburgerBtn = document.getElementById('hamburgerBtn');
            const mainNav = document.getElementById('mainNav');
            const userMenuBtn = document.getElementById('userMenuBtn');
            const userDropdown = document.getElementById('userDropdown');
            const userMenuContainer = document.querySelector('.user-menu-container');

            let userMenuOpen = false;

            // Men√∫ hamburguesa
            if (hamburgerBtn && mainNav) {
                hamburgerBtn.addEventListener('click', () => {
                    mainNav.classList.toggle('active');
                    hamburgerBtn.classList.toggle('is-active');
                });
            }

            // Dropdown de usuario
            function toggleUserMenu() {
                userMenuOpen = !userMenuOpen;
                if (userDropdown) {
                    userDropdown.style.display = userMenuOpen ? 'block' : 'none';
                }
            }

            function updateUserMenu() {
                const user = JSON.parse(localStorage.getItem('user'));
                const userInfo = document.getElementById('userInfo');
                const userName = document.getElementById('userName');
                const adminLink = document.getElementById('adminLink');
                const userGuest = document.getElementById('userGuest');
                const logoutBtn = document.getElementById('logoutBtn');

                if (user) {
                    if (userInfo) userInfo.style.display = 'flex';
                    if (logoutBtn) logoutBtn.style.display = 'flex';
                    if (userGuest) userGuest.style.display = 'none';
                    if (userName) userName.textContent = user.nombre || 'Usuario';
                    if (adminLink) adminLink.style.display = user.role === 'admin' ? 'flex' : 'none';
                } else {
                    if (userInfo) userInfo.style.display = 'none';
                    if (adminLink) adminLink.style.display = 'none';
                    if (logoutBtn) logoutBtn.style.display = 'none';
                    if (userGuest) userGuest.style.display = 'block';
                }
            }

            window.logout = function () {
                if (confirm('¬øEst√°s seguro de que deseas cerrar sesi√≥n?')) {
                    localStorage.removeItem('token');
                    localStorage.removeItem('user');
                    localStorage.removeItem('cart');
                    updateUserMenu();
                    toggleUserMenu();
                    window.location.href = '/pages/login.html';
                }
            };

            if (userMenuBtn) {
                userMenuBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    toggleUserMenu();
                });
            }

            document.addEventListener('click', function (e) {
                if (userMenuOpen && userMenuContainer && !userMenuContainer.contains(e.target)) {
                    toggleUserMenu();
                }
            });

            updateUserMenu();
        });

        // ============================================
        // üöÄ INICIALIZACI√ìN
        // ============================================
        window.addEventListener('load', async () => {
            console.log('üöÄ Iniciando carga de la p√°gina...');

            try {
                // 1. Cargar servicios (esto llena el banner)
                await loadServicesFromDB();

                // 2. Cargar productos destacados
                await loadProducts();

                // 3. Cargar informaci√≥n de contacto
                await loadDynamicContact();

                // 4. Iniciar autoplay
                startAutoplay();

                console.log('‚úÖ P√°gina cargada completamente');
            } catch (error) {
                console.error('‚ùå Error durante la inicializaci√≥n:', error);
            }
        });

        // Scroll suave
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const href = this.getAttribute('href');
                if (!href || href === '#') return;

                const target = document.getElementById(href.substring(1));
                if (!target) return;

                e.preventDefault();
                target.scrollIntoView({ behavior: 'smooth' });
            });
        });

        // Actualizar carrito al cargar
        window.addEventListener('DOMContentLoaded', () => {
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');

            if (user.name) {
                const userNameEl = document.getElementById('userName');
                if (userNameEl) userNameEl.textContent = user.name;
            }

            if (user.role === 'admin') {
                const adminLink = document.getElementById('adminLink');
                if (adminLink) adminLink.style.display = 'flex';
            }

            if (cart.length > 0) {
                const cartCount = document.getElementById('cartCount');
                if (cartCount) {
                    cartCount.textContent = cart.length;
                    cartCount.style.display = 'block';
                }
            }
        });
    </script>

    <!-- ‚ú® SCRIPTS EXTERNOS -->
    <script src="/js/apply-colors.js"></script>
    <script src="/js/common-footer.js"></script>
    <script src="/js/common-header.js"></script>
    <script src="/js/whatsapp-float.js"></script>
</body>

</html>